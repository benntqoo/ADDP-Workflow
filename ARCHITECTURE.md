# æ­£ç¢ºæ¶æ§‹è¨­è¨ˆæ–‡æª”
*AI Terminal Proxy - çµ‚ç«¯ä»£ç† + MCP ç¨ç«‹é›™è»Œæ¶æ§‹*

## ğŸ¯ æ¶æ§‹æ¦‚è¦½ï¼ˆç³¾æ­£ç‰ˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Golang GUI çµ‚ç«¯ä»£ç†                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Bubble Tea  â”‚  â”‚   Ollama    â”‚  â”‚    Terminal         â”‚ â”‚
â”‚  â”‚     TUI     â”‚  â”‚ æŸ¥è©¢å„ªåŒ–å™¨    â”‚  â”‚     Manager         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ å„ªåŒ–å¾Œå‘½ä»¤ç™¼é€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¤šçµ‚ç«¯ä»£ç†å±¤                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Claude Code â”‚  â”‚ Gemini CLI  â”‚  â”‚  Cursor/Aider       â”‚ â”‚
â”‚  â”‚   Terminal  â”‚  â”‚   Terminal  â”‚  â”‚    Terminals        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Python MCP ç¨ç«‹æœå‹™ï¼ˆç”¨æˆ¶å¯é¸é…ç½®ï¼‰             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚     TDD     â”‚  â”‚  Workflow   â”‚  â”‚      Memory         â”‚ â”‚
â”‚  â”‚   Tools     â”‚  â”‚   Manager   â”‚  â”‚     System          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ Golang çµ‚ç«¯ä»£ç†è¨­è¨ˆ

### æ ¸å¿ƒè·è²¬
1. **GUI ç•Œé¢ç®¡ç†**ï¼šæä¾›çµ±ä¸€çš„çµ‚ç«¯æ“ä½œç•Œé¢
2. **å¤šçµ‚ç«¯ä»£ç†**ï¼šç®¡ç† claude/gemini/cursor/aider ç­‰å¤šå€‹çµ‚ç«¯é€²ç¨‹
3. **æŸ¥è©¢å„ªåŒ–**ï¼šä½¿ç”¨ Ollama å„ªåŒ–ç”¨æˆ¶è¼¸å…¥
4. **å‘½ä»¤è·¯ç”±**ï¼šå°‡å„ªåŒ–å¾Œçš„å‘½ä»¤ç™¼é€åˆ°å°æ‡‰çš„ AI å·¥å…·çµ‚ç«¯

### ä¸»è¦çµ„ä»¶

#### 1. çµ‚ç«¯ç®¡ç†å™¨
```go
// internal/terminal/manager.go
package terminal

import (
    "bufio"
    "context"
    "os/exec"
    "sync"
)

type TerminalManager struct {
    terminals map[string]*Terminal
    mu        sync.RWMutex
}

type Terminal struct {
    Name    string
    Type    TerminalType
    Process *exec.Cmd
    Stdin   *bufio.Writer
    Stdout  *bufio.Scanner
    Active  bool
}

type TerminalType int
const (
    TypeClaudeCode TerminalType = iota
    TypeGeminiCLI
    TypeCursor
    TypeAider
    TypeCustom
)

func NewTerminalManager() *TerminalManager {
    return &TerminalManager{
        terminals: make(map[string]*Terminal),
    }
}

func (tm *TerminalManager) StartTerminal(name string, termType TerminalType) error {
    cmd := tm.getTerminalCommand(termType)

    terminal := &Terminal{
        Name:    name,
        Type:    termType,
        Process: cmd,
        Active:  true,
    }

    // è¨­ç½®è¼¸å…¥è¼¸å‡ºç®¡é“
    stdin, err := cmd.StdinPipe()
    if err != nil {
        return err
    }
    terminal.Stdin = bufio.NewWriter(stdin)

    stdout, err := cmd.StdoutPipe()
    if err != nil {
        return err
    }
    terminal.Stdout = bufio.NewScanner(stdout)

    // å•Ÿå‹•é€²ç¨‹
    if err := cmd.Start(); err != nil {
        return err
    }

    tm.mu.Lock()
    tm.terminals[name] = terminal
    tm.mu.Unlock()

    return nil
}

func (tm *TerminalManager) SendCommand(terminalName string, command string) error {
    tm.mu.RLock()
    terminal, exists := tm.terminals[terminalName]
    tm.mu.RUnlock()

    if !exists {
        return fmt.Errorf("terminal %s not found", terminalName)
    }

    _, err := terminal.Stdin.WriteString(command + "\n")
    if err != nil {
        return err
    }

    return terminal.Stdin.Flush()
}

func (tm *TerminalManager) getTerminalCommand(termType TerminalType) *exec.Cmd {
    switch termType {
    case TypeClaudeCode:
        return exec.Command("claude")
    case TypeGeminiCLI:
        return exec.Command("gemini")
    case TypeCursor:
        return exec.Command("cursor", "--cli")
    case TypeAider:
        return exec.Command("aider")
    default:
        return exec.Command("bash")
    }
}
```

#### 2. Ollama æŸ¥è©¢å„ªåŒ–å™¨
```go
// internal/optimizer/ollama.go
package optimizer

import (
    "context"
    "github.com/ollama/ollama/api"
)

type QueryOptimizer struct {
    client *api.Client
    model  string
}

func NewQueryOptimizer() (*QueryOptimizer, error) {
    client, err := api.ClientFromEnvironment()
    if err != nil {
        return nil, err
    }

    return &QueryOptimizer{
        client: client,
        model:  "qwen2.5:14b",
    }, nil
}

func (qo *QueryOptimizer) OptimizeForTerminal(ctx context.Context, query string, targetTerminal TerminalType) (string, error) {
    template := qo.getOptimizationTemplate(targetTerminal)

    req := &api.ChatRequest{
        Model: qo.model,
        Messages: []api.Message{
            {Role: "system", Content: template},
            {Role: "user", Content: query},
        },
        Stream: false,
    }

    resp, err := qo.client.Chat(ctx, req)
    if err != nil {
        return "", err
    }

    return resp.Message.Content, nil
}

func (qo *QueryOptimizer) getOptimizationTemplate(termType TerminalType) string {
    switch termType {
    case TypeClaudeCode:
        return `ä½ æ˜¯ Claude Code å‘½ä»¤å„ªåŒ–å°ˆå®¶ã€‚å°‡ç”¨æˆ¶çš„è‡ªç„¶èªè¨€è«‹æ±‚è½‰æ›ç‚ºæœ€é©åˆçš„ Claude Code å‘½ä»¤æ ¼å¼ã€‚

è¦å‰‡ï¼š
1. ä½¿ç”¨ Claude Code çš„å…§å»ºå‘½ä»¤æ ¼å¼ (/sync, /plan, /context ç­‰)
2. ä¿æŒç°¡æ½”æ˜ç¢º
3. å¦‚æœæ˜¯ä»£ç¢¼ç›¸é—œï¼Œæ·»åŠ å…·é«”çš„æ–‡ä»¶æˆ–æ¨¡å¡Šä¿¡æ¯
4. è¼¸å‡ºæ ¼å¼ï¼šç›´æ¥è¼¸å‡ºå„ªåŒ–å¾Œçš„å‘½ä»¤ï¼Œä¸è¦é¡å¤–è§£é‡‹

ç”¨æˆ¶è¼¸å…¥ï¼š`

    case TypeGeminiCLI:
        return `ä½ æ˜¯ Gemini CLI æŸ¥è©¢å„ªåŒ–å°ˆå®¶ã€‚å°‡ç”¨æˆ¶è«‹æ±‚å„ªåŒ–ç‚ºé©åˆ Gemini çš„è‡ªç„¶èªè¨€æç¤ºã€‚

è¦å‰‡ï¼š
1. ä½¿ç”¨æ¸…æ™°çš„è‡ªç„¶èªè¨€æè¿°
2. å¦‚æœæ¶‰åŠä»£ç¢¼ï¼Œè¦æ±‚æä¾›å…·é«”ç¤ºä¾‹
3. çµæ§‹åŒ–è¡¨é”éœ€æ±‚
4. è¼¸å‡ºæ ¼å¼ï¼šå„ªåŒ–å¾Œçš„è‡ªç„¶èªè¨€æŸ¥è©¢

ç”¨æˆ¶è¼¸å…¥ï¼š`

    case TypeCursor:
        return `ä½ æ˜¯ Cursor AI æç¤ºå„ªåŒ–å°ˆå®¶ã€‚å°‡ç”¨æˆ¶è«‹æ±‚è½‰æ›ç‚º Cursor æœ€å®¹æ˜“ç†è§£çš„ä»£ç¢¼ç›¸é—œæŸ¥è©¢ã€‚

è¦å‰‡ï¼š
1. å°ˆæ³¨æ–¼ä»£ç¢¼ç·¨è¼¯å’Œé‡æ§‹
2. æ˜ç¢ºæŒ‡å‡ºè¦ä¿®æ”¹çš„æ–‡ä»¶å’Œä½ç½®
3. æä¾›æœŸæœ›çš„è¼¸å‡ºæ ¼å¼
4. è¼¸å‡ºæ ¼å¼ï¼šå„ªåŒ–å¾Œçš„ Cursor æŸ¥è©¢

ç”¨æˆ¶è¼¸å…¥ï¼š`

    case TypeAider:
        return `ä½ æ˜¯ Aider å‘½ä»¤å„ªåŒ–å°ˆå®¶ã€‚å°‡ç”¨æˆ¶è«‹æ±‚è½‰æ›ç‚º Aider çš„è‡ªç„¶èªè¨€ç·¨ç¨‹æŒ‡ä»¤ã€‚

è¦å‰‡ï¼š
1. ä½¿ç”¨ Aider åå¥½çš„ç·¨ç¨‹èªè¨€æè¿°
2. æ˜ç¢ºè¦ä¿®æ”¹æˆ–å‰µå»ºçš„æ–‡ä»¶
3. æä¾›æ¸…æ™°çš„åŠŸèƒ½æè¿°
4. è¼¸å‡ºæ ¼å¼ï¼šå„ªåŒ–å¾Œçš„ Aider æŒ‡ä»¤

ç”¨æˆ¶è¼¸å…¥ï¼š`

    default:
        return "å„ªåŒ–ä»¥ä¸‹æŸ¥è©¢ä½¿å…¶æ›´åŠ æ¸…æ™°å’Œå…·é«”ï¼š"
    }
}
```

#### 3. GUI ç•Œé¢
```go
// internal/gui/model.go
package gui

import (
    "github.com/charmbracelet/bubbles/list"
    "github.com/charmbracelet/bubbles/textinput"
    tea "github.com/charmbracelet/bubbletea"
)

type Model struct {
    // ç•Œé¢ç‹€æ…‹
    width, height   int
    activePane      Pane

    // è¼¸å…¥çµ„ä»¶
    textInput       textinput.Model
    terminalList    list.Model

    // çµ‚ç«¯ç®¡ç†
    terminalManager *terminal.TerminalManager
    queryOptimizer  *optimizer.QueryOptimizer

    // çµ‚ç«¯è¼¸å‡º
    terminals       map[string]*TerminalOutput
    selectedTerminal string
}

type Pane int
const (
    PaneInput Pane = iota
    PaneTerminalList
    PaneOutput
)

type TerminalOutput struct {
    Name     string
    Type     terminal.TerminalType
    Content  []string
    Active   bool
}

func (m Model) Init() tea.Cmd {
    return tea.Batch(
        textinput.Blink,
        m.loadAvailableTerminals(),
    )
}

func (m Model) Update(msg tea.Msg) (tea.Model, tea.Cmd) {
    var cmds []tea.Cmd

    switch msg := msg.(type) {
    case tea.KeyMsg:
        switch msg.String() {
        case "ctrl+c", "q":
            return m, tea.Quit
        case "tab":
            return m.switchPane()
        case "enter":
            if m.activePane == PaneInput {
                return m.handleUserInput()
            }
        case "1", "2", "3", "4":
            return m.selectTerminal(msg.String())
        }
    case tea.WindowSizeMsg:
        m.width = msg.Width
        m.height = msg.Height
    }

    // æ›´æ–°å­çµ„ä»¶
    var cmd tea.Cmd
    m.textInput, cmd = m.textInput.Update(msg)
    cmds = append(cmds, cmd)

    return m, tea.Batch(cmds...)
}

func (m Model) View() string {
    var sections []string

    // é ‚éƒ¨ï¼šè¼¸å…¥å€åŸŸ
    sections = append(sections, m.renderInputSection())

    // ä¸­éƒ¨ï¼šçµ‚ç«¯é¸æ“‡
    sections = append(sections, m.renderTerminalSelection())

    // åº•éƒ¨ï¼šè¼¸å‡ºå€åŸŸ
    sections = append(sections, m.renderOutputSection())

    // ç‹€æ…‹æ¬„
    sections = append(sections, m.renderStatusBar())

    return strings.Join(sections, "\n")
}

func (m Model) handleUserInput() (Model, tea.Cmd) {
    userInput := m.textInput.Value()
    if userInput == "" {
        return m, nil
    }

    // ç²å–ç•¶å‰é¸ä¸­çš„çµ‚ç«¯
    selectedTerminal := m.getSelectedTerminal()
    if selectedTerminal == nil {
        return m, nil
    }

    // ä½¿ç”¨ Ollama å„ªåŒ–æŸ¥è©¢
    optimizedQuery, err := m.queryOptimizer.OptimizeForTerminal(
        context.Background(),
        userInput,
        selectedTerminal.Type,
    )
    if err != nil {
        return m, m.showError(err)
    }

    // ç™¼é€åˆ°çµ‚ç«¯
    err = m.terminalManager.SendCommand(selectedTerminal.Name, optimizedQuery)
    if err != nil {
        return m, m.showError(err)
    }

    // æ¸…ç©ºè¼¸å…¥
    m.textInput.SetValue("")

    // è¨˜éŒ„æ“ä½œ
    m.addToOutput(selectedTerminal.Name, fmt.Sprintf("> %s", userInput))
    m.addToOutput(selectedTerminal.Name, fmt.Sprintf("å„ªåŒ–å¾Œ: %s", optimizedQuery))

    return m, nil
}
```

## ğŸ Python MCP ç¨ç«‹æœå‹™è¨­è¨ˆ

### æ ¸å¿ƒç†å¿µ
- **å®Œå…¨ç¨ç«‹**ï¼šèˆ‡ Golang GUI ç„¡ä»»ä½•è¯å‹•
- **ç”¨æˆ¶å¯é¸**ï¼šæ ¹æ“šä½¿ç”¨çš„ AI å·¥å…·è‡ªè¡Œé…ç½®
- **TDD é©…å‹•**ï¼šå°ˆæ³¨æ–¼é–‹ç™¼æµç¨‹æ¨™æº–åŒ–

### MCP æœå‹™æ¶æ§‹
```python
# src/mcp_server/__main__.py
import asyncio
import argparse
from mcp.server import Server

class ADDPMCPServer:
    """ç¨ç«‹çš„ ADDP MCP æœå‹™å™¨ï¼Œç”¨æˆ¶å¯é¸é…ç½®"""

    def __init__(self):
        self.server = Server("addp-tdd-tools")
        self.setup_tools()

    def setup_tools(self):
        """è¨­ç½® TDD æµç¨‹åŒ–å·¥å…·"""
        from .tools import (
            InitProjectTool,
            PlanUpdateTool,
            TestRunTool,
            GuardValidateTool,
            MemoryManagerTool,
            SpecGeneratorTool
        )

        # è¨»å†Šå·¥å…·
        self.server.register_tool(InitProjectTool())
        self.server.register_tool(PlanUpdateTool())
        self.server.register_tool(TestRunTool())
        self.server.register_tool(GuardValidateTool())
        self.server.register_tool(MemoryManagerTool())
        self.server.register_tool(SpecGeneratorTool())

    async def run(self):
        """é‹è¡Œ MCP æœå‹™å™¨"""
        if "--stdio" in sys.argv:
            await self.server.run_stdio()
        else:
            await self.server.run_sse("http://localhost:8000")

async def main():
    parser = argparse.ArgumentParser(description="ADDP TDD MCP Server")
    parser.add_argument("--stdio", action="store_true", help="Run in STDIO mode")
    parser.add_argument("--port", type=int, default=8000, help="HTTP server port")

    args = parser.parse_args()

    server = ADDPMCPServer()
    await server.run()

if __name__ == "__main__":
    asyncio.run(main())
```

### TDD å·¥å…·é›†
```python
# src/mcp_server/tools/tdd_tools.py
from mcp.types import Tool

class TestRunTool(Tool):
    """TDD æ¸¬è©¦åŸ·è¡Œå·¥å…·"""

    def __init__(self):
        super().__init__(
            name="test.run",
            description="Run tests with TDD validation"
        )

    async def execute(self, test_type="all", **kwargs):
        """åŸ·è¡Œæ¸¬è©¦ä¸¦é©—è­‰ TDD æµç¨‹"""
        result = {
            "test_type": test_type,
            "status": "running",
            "results": [],
            "coverage": {},
            "tdd_validation": {}
        }

        # 1. åŸ·è¡Œæ¸¬è©¦
        if test_type in ["all", "unit"]:
            unit_results = await self._run_unit_tests()
            result["results"].append(unit_results)

        if test_type in ["all", "integration"]:
            integration_results = await self._run_integration_tests()
            result["results"].append(integration_results)

        # 2. ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
        result["coverage"] = await self._generate_coverage_report()

        # 3. TDD æµç¨‹é©—è­‰
        result["tdd_validation"] = await self._validate_tdd_process()

        return result

class GuardValidateTool(Tool):
    """é–‹ç™¼é–€ç¦é©—è­‰å·¥å…·"""

    async def execute(self, phase, artifacts, **kwargs):
        """åŸ·è¡Œé–‹ç™¼é–€ç¦é©—è­‰"""
        validation = {
            "phase": phase,
            "valid": True,
            "gates": {},
            "violations": []
        }

        # TDD é–€ç¦
        if phase == "development":
            tdd_gate = await self._validate_tdd_gate(artifacts)
            validation["gates"]["tdd"] = tdd_gate
            if not tdd_gate["passed"]:
                validation["valid"] = False

        # æ¸¬è©¦è¦†è“‹ç‡é–€ç¦
        coverage_gate = await self._validate_coverage_gate(artifacts)
        validation["gates"]["coverage"] = coverage_gate
        if coverage_gate["coverage"] < 0.8:
            validation["violations"].append("Coverage below 80%")

        return validation
```

## ğŸ”„ ç”¨æˆ¶é…ç½®æ–¹å¼

### 1. Claude Code ç”¨æˆ¶é…ç½®
```json
// ~/.claude/mcp.json
{
  "servers": {
    "addp-tdd": {
      "command": "python",
      "args": ["-m", "src.mcp_server", "--stdio"],
      "cwd": "/path/to/claude-terminal-proxy"
    }
  }
}
```

### 2. Cursor ç”¨æˆ¶é…ç½®
```json
// .cursor/mcp_servers.json
{
  "addp-tdd-tools": {
    "command": "python",
    "args": ["-m", "src.mcp_server", "--stdio"],
    "env": {
      "ADDP_MODE": "cursor"
    }
  }
}
```

### 3. å…¶ä»– AI å·¥å…·
ç”¨æˆ¶æ ¹æ“šå„è‡ª AI å·¥å…·çš„ MCP é…ç½®æ–¹å¼è‡ªè¡Œè¨­ç½®ã€‚

## ğŸ“ æ­£ç¢ºçš„é …ç›®çµæ§‹

```
D:\Code\fos\AI\claude\
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ main.go              # Golang ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ gui/                 # TUI ç•Œé¢
â”‚   â”œâ”€â”€ terminal/            # çµ‚ç«¯ç®¡ç†
â”‚   â”œâ”€â”€ optimizer/           # Ollama æŸ¥è©¢å„ªåŒ–
â”‚   â””â”€â”€ config/              # é…ç½®ç®¡ç†
â”œâ”€â”€ src/                     # Python MCP æœå‹™ï¼ˆç¨ç«‹ï¼‰
â”‚   â””â”€â”€ mcp_server/
â”‚       â”œâ”€â”€ __main__.py      # MCP æœå‹™å…¥å£
â”‚       â”œâ”€â”€ tools/           # TDD å·¥å…·é›†
â”‚       â””â”€â”€ workflow/        # å·¥ä½œæµç®¡ç†
â”œâ”€â”€ templates/               # æŸ¥è©¢å„ªåŒ–æ¨¡æ¿
â”œâ”€â”€ configs/                 # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ scripts/                 # éƒ¨ç½²è…³æœ¬
â”œâ”€â”€ go.mod                   # Go æ¨¡å¡Šå®šç¾©
â””â”€â”€ pyproject.toml          # Python åŒ…å®šç¾©
```

## ğŸ¯ é–‹ç™¼å„ªå…ˆç´šé‡æ–°æ’åˆ—

### Week 1-2: Golang çµ‚ç«¯ä»£ç†æ ¸å¿ƒ
1. çµ‚ç«¯ç®¡ç†å™¨å¯¦ç¾
2. Ollama é›†æˆå’ŒæŸ¥è©¢å„ªåŒ–
3. åŸºç¤ TUI ç•Œé¢

### Week 3-4: å¤šçµ‚ç«¯é©é…
1. Claude Code çµ‚ç«¯é©é…
2. Gemini CLI çµ‚ç«¯é©é…
3. Cursor/Aider çµ‚ç«¯é©é…

### Week 5-7: Python MCP ç¨ç«‹é–‹ç™¼
1. TDD å·¥å…·é›†å¯¦ç¾
2. å·¥ä½œæµç®¡ç†
3. ç”¨æˆ¶é…ç½®æ–‡æª”

---

é€™å€‹ç³¾æ­£ç‰ˆæ¶æ§‹ç¾åœ¨ç¬¦åˆæ‚¨çš„çœŸå¯¦éœ€æ±‚ï¼š

1. **Golang GUI** = çµ‚ç«¯ä»£ç† + Ollama å„ªåŒ– + å¤šçµ‚ç«¯ç®¡ç†
2. **Python MCP** = ç¨ç«‹çš„ TDD æµç¨‹åŒ–å·¥å…·ï¼Œç”¨æˆ¶å¯é¸é…ç½®
3. **å…©è€…å®Œå…¨è§£è€¦**ï¼Œå„è‡ªç¨ç«‹é–‹ç™¼å’Œéƒ¨ç½²

## ğŸ¯ ç›®æ¨™èˆ‡é©—æ”¶æ¨™æº– (Objectives & DoD)

### é …ç›®ç›®æ¨™ (Objectives)

#### Golang çµ‚ç«¯ä»£ç†ç›®æ¨™
- **æœ¬åœ°æ™ºèƒ½ä»£ç†**ï¼šæä¾›çµ‚ç«¯ç‰ˆ AI IDEï¼Œè§£ææ–œç·šå‘½ä»¤ï¼ŒåŸ·è¡Œæœ¬åœ°æ“ä½œï¼ˆOllamaã€æ¨¡æ¿åŒ–ã€æŸ¥è©¢å„ªåŒ–ï¼‰ï¼Œåƒ…åœ¨éœ€è¦æ™‚å°‡å„ªåŒ–å¾Œçš„æœ€å°æç¤ºç§»äº¤çµ¦å¤–éƒ¨ AI CLI å·¥å…·
- **çµ±ä¸€çµ‚ç«¯ç®¡ç†**ï¼šé€éå–®ä¸€ GUI ç•Œé¢ç®¡ç†å¤šå€‹ AI CLI å·¥å…·ï¼ˆClaude Codeã€Gemini CLIã€Cursorã€Aiderï¼‰ï¼Œæä¾›ä¸€è‡´çš„æ“ä½œé«”é©—
- **Token ç¶“æ¿Ÿå„ªåŒ–**ï¼šé€šéæœ¬åœ°æç¤ºå„ªåŒ–ã€ä¸Šä¸‹æ–‡æ‰“åŒ…ã€ç·©å­˜å’Œé ç®—è­·æ¬„æ¸›å°‘å¾€è¿”å’Œå†—é¤˜ï¼Œç¯€çœ 30-50% çš„ token ä½¿ç”¨
- **è·¨ CLI æ©‹æ¥**ï¼šé€šé"æç¤º+ä¸Šä¸‹æ–‡ç§»äº¤"å’ŒæŒ‰å·¥å…·é©é…å™¨æ¨™æº–åŒ– Claude/Gemini/Cursor ç­‰å·¥å…·ä¹‹é–“çš„å·®ç•°

#### Python MCP å·¥å…·ç›®æ¨™
- **ç´€å¾‹æ€§äº¤ä»˜**ï¼šå¼·åˆ¶åŸ·è¡Œ TDD å’Œè³ªé‡é–€ç¦ï¼ˆç™½åå–®ä¿®è£œã€éšæ®µé †åºã€è¦†è“‹ç‡é–¾å€¼ï¼‰ä½œç‚ºåˆä½µé˜»æ­¢æ¢ä»¶
- **å¯å¯©è¨ˆç‹€æ…‹**ï¼šåœ¨ `.addp/**` ä¸‹æŒä¹…åŒ–é‹è¡Œè¨˜éŒ„ã€æ±ºç­–ã€ç”¢ç‰©å’Œåˆ†æï¼Œä½¿ç”¨ MCP_RUN_ID ç«¯åˆ°ç«¯è¿½è¹¤æµç¨‹
- **çµ±ä¸€ MCP å·¥å…·**ï¼šé€šé stdio/JSON-RPC åœ¨ä»»ä½• AI CLI ä¸­æš´éœ² ADDP ä¸€è‡´å·¥å…·é›†ï¼Œå…·æœ‰æ¸…æ™°çš„å¥‘ç´„å’Œå®‰å…¨çš„å‰¯ä½œç”¨

### å®Œæˆå®šç¾© (Definition of Done)

#### Golang çµ‚ç«¯ä»£ç† DoD

**åŸºç¤åŠŸèƒ½é©—æ”¶**ï¼š
- [ ] TUI ç•Œé¢é‹è¡Œæµæš¢ï¼Œæ”¯æ´ Tab éµåˆ‡æ›é¢æ¿ï¼Œ1-4 æ•¸å­—éµé¸æ“‡çµ‚ç«¯
- [ ] æˆåŠŸå•Ÿå‹•å’Œç®¡ç† 4 ç¨®çµ‚ç«¯é¡å‹ï¼šClaude Codeã€Gemini CLIã€Cursorã€Aider
- [ ] Ollama é›†æˆå·¥ä½œæ­£å¸¸ï¼ŒæŸ¥è©¢å„ªåŒ–éŸ¿æ‡‰æ™‚é–“ < 2 ç§’
- [ ] çµ‚ç«¯é€²ç¨‹ç®¡ç†ç©©å®šï¼šå•Ÿå‹•/åœæ­¢/é‡å•ŸåŠŸèƒ½ç„¡éŒ¯èª¤
- [ ] è·¨å¹³å°å…¼å®¹ï¼šWindowsã€Linuxã€macOS ä¸€éµç·¨è­¯å’Œé‹è¡Œ

**å„ªåŒ–æ•ˆæœé©—æ”¶**ï¼š
- [ ] é‡å°ä¸åŒ AI å·¥å…·çš„æŸ¥è©¢å„ªåŒ–æ¨¡æ¿å®Œæ•´ä¸”æœ‰æ•ˆ
- [ ] Token ç¯€çœç‡é”åˆ° 30% ä»¥ä¸Šï¼ˆèˆ‡ç›´æ¥ä½¿ç”¨ AI å·¥å…·å°æ¯”ï¼‰
- [ ] æŸ¥è©¢å„ªåŒ–æº–ç¢ºç‡ > 85%ï¼ˆç”¨æˆ¶æ»¿æ„åº¦è©•ä¼°ï¼‰
- [ ] æœ¬åœ°ç·©å­˜å‘½ä¸­ç‡ > 60%ï¼Œé‡è¤‡æŸ¥è©¢éŸ¿æ‡‰æ™‚é–“ < 1 ç§’

**ç©©å®šæ€§é©—æ”¶**ï¼š
- [ ] é€£çºŒé‹è¡Œ 2+ å°æ™‚ç„¡å´©æ½°
- [ ] è¨˜æ†¶é«”ä½¿ç”¨ < 100MBï¼ˆç©ºé–’æ™‚ï¼‰
- [ ] CPU ä½¿ç”¨ç‡ < 5%ï¼ˆç©ºé–’æ™‚ï¼‰
- [ ] çµ‚ç«¯ç•°å¸¸æ™‚è‡ªå‹•æ¢å¾©æ©Ÿåˆ¶æœ‰æ•ˆ

#### Python MCP ç¨ç«‹æœå‹™ DoD

**MCP å”è­°åˆè¦**ï¼š
- [ ] é€šé stdio/JSON-RPC é‹è¡Œï¼Œå…·æœ‰æ–‡æª”åŒ–çš„è«‹æ±‚/éŸ¿æ‡‰æ¨¡å¼å’Œè¶…æ™‚è¨­ç½®
- [ ] å¯ç”¨å·¥å…·é›†ï¼š`query.optimize`ã€`plan.update`ã€`fs.apply_patch`ï¼ˆç™½åå–®+dry-runï¼‰ã€`test.run`ã€`guard.validate_flow`ã€`mem.save_phase`ã€`prompt.render`ã€`context.pack`
- [ ] æ‰€æœ‰å·¥å…·å…·æœ‰çµæ§‹åŒ– IOï¼šæ˜ç¢ºçš„åƒæ•¸ã€è¿”å›å€¼ã€éŒ¯èª¤è™•ç†

**å®‰å…¨èˆ‡é–€ç¦**ï¼š
- [ ] `fs.apply_patch` æ‹’çµ•éç™½åå–®è·¯å¾‘ä¸¦è¨˜éŒ„æ‹’çµ•æ“ä½œ
- [ ] `test.run` è¿”å›æ©Ÿå™¨å¯è®€å ±å‘Šï¼›`guard.validate_flow` åœ¨æ¸¬è©¦å¤±æ•—ã€ç¼ºå°‘ Redâ†’Green æˆ–è¦†è“‹ç‡ < é…ç½®é–¾å€¼æ™‚é˜»æ­¢
- [ ] å¼·åˆ¶åŸ·è¡Œéšæ®µé †åºï¼ˆADDPï¼‰ï¼›é•è¦æ™‚å ±å‘Šä¸¦æä¾›ä¿®å¾©æç¤º

**æœ¬åœ°å„ªå…ˆæµç¨‹**ï¼š
- [ ] `/init` åˆå§‹åŒ– `.addp/{specifications,workflows,memory,queries,gates,sync,configs}` ä¸¦ç¨®å­åŒ–æ¨¡æ¿
- [ ] å®Œæ•´å·¥ä½œæµï¼š`query.optimize` â†’ `prompt.render` â†’ `context.pack` ç”¢ç”Ÿæœ€å°åŒ–æç¤ºåŒ…æº–å‚™ç§»äº¤
- [ ] èˆ‡è‡³å°‘ä¸€å€‹ AI CLI çš„ç§»äº¤æ¼”ç¤ºå·¥ä½œï¼Œä¸¦å°‡çµæœå¾€è¿”å›æœ¬åœ°è¨˜æ†¶/ç‹€æ…‹

**æŒä¹…åŒ–èˆ‡å¯è§€æ¸¬æ€§**ï¼š
- [ ] æ¯æ¬¡èª¿ç”¨å¯«å…¥ MCP_RUN_IDã€è¼¸å…¥ã€è¼¸å‡ºå’Œé–€ç¦çµæœåˆ° `.addp/**`
- [ ] è¨˜éŒ„åŸºæœ¬åˆ†æï¼ˆå»¶é² P50/P95ã€ç·©å­˜å‘½ä¸­ç‡ã€å¤±æ•—ä»£ç¢¼ã€token ä¼°è¨ˆï¼‰
- [ ] å·¥å…·åŸ·è¡ŒæˆåŠŸç‡ > 95%ï¼ŒéŒ¯èª¤æœ‰æ¸…æ™°çš„è¨ºæ–·ä¿¡æ¯

**é…ç½®èˆ‡æ–‡æª”**ï¼š
- [ ] æä¾› Claude Codeã€Cursor çš„ MCP é…ç½®æ¨¡æ¿
- [ ] é…ç½®æ¨¡æ¿åœ¨å„ AI å·¥å…·ä¸­å¯ç”¨æ€§ > 90%
- [ ] æ•…éšœæ’é™¤æ–‡æª”å®Œæ•´ï¼Œå¸¸è¦‹å•é¡Œæœ‰æ˜ç¢ºè§£æ±ºæ–¹æ¡ˆ

#### æ•´é«”é …ç›® DoD

**éƒ¨ç½²èˆ‡ç”¨æˆ¶é«”é©—**ï¼š
- [ ] README å¿«é€Ÿé–‹å§‹æµç¨‹ç«¯åˆ°ç«¯é‹è¡ŒæˆåŠŸ
- [ ] æ–°ç”¨æˆ¶ 5 åˆ†é˜å…§æˆåŠŸå•Ÿå‹•ä¸¦ä½¿ç”¨åŸºæœ¬åŠŸèƒ½
- [ ] ä¸€éµå®‰è£è…³æœ¬æ”¯æ´ä¸»æµå¹³å°
- [ ] Windows æ§åˆ¶å°å¼•è™Ÿå’Œç·¨ç¢¼è¡Œç‚ºå·²è¨˜éŒ„

**æ–‡æª”å®Œæ•´æ€§**ï¼š
- [ ] æ¶æ§‹æ¥å£ç›®éŒ„åˆ—å‡ºå·¥å…·åç¨±ã€åƒæ•¸ã€è¿”å›å€¼ã€éŒ¯èª¤å’Œå‰¯ä½œç”¨
- [ ] é–‹ç™¼è¨ˆåŠƒå°‡é‡Œç¨‹ç¢‘èˆ‡å¯æ¼”ç¤ºå‘½ä»¤å’Œ CI é–€ç¦ç¶å®š
- [ ] åŒ…å«å¯¦éš›ä½¿ç”¨æ¡ˆä¾‹çš„æœ€ä½³å¯¦è¸æ–‡æª”

**è³ªé‡ä¿è­‰**ï¼š
- [ ] ç…™éœ§æ¸¬è©¦åœ¨ Windows/macOS/Linux é€šé
- [ ] æ ¸å¿ƒåŠŸèƒ½å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ > 80%
- [ ] é›†æˆæ¸¬è©¦è¦†è“‹ä¸»è¦ç”¨æˆ¶æµç¨‹
- [ ] æ€§èƒ½åŸºæº–æ¸¬è©¦å»ºç«‹ä¸¦å¯é‡ç¾

### æœ€å°å¯è¡Œå·¥å…·é›† (Minimum Viable Toolset)

#### Python MCP æ ¸å¿ƒå·¥å…·
1. **query.optimize** - Ollama é©…å‹•çš„æŸ¥è©¢å„ªåŒ–
2. **plan.update** - é …ç›®è¨ˆåŠƒæ›´æ–°å’Œç‹€æ…‹ç®¡ç†
3. **fs.apply_patch** - å®‰å…¨çš„æ–‡ä»¶ç³»çµ±ä¿®è£œï¼ˆç™½åå–®ä¿è­·ï¼‰
4. **test.run** - TDD æ¸¬è©¦åŸ·è¡Œå’Œé©—è­‰
5. **guard.validate_flow** - é–‹ç™¼æµç¨‹é–€ç¦é©—è­‰
6. **mem.save_phase** - é …ç›®è¨˜æ†¶å’Œç‹€æ…‹æŒä¹…åŒ–
7. **prompt.render** - æç¤ºè©æ¨¡æ¿æ¸²æŸ“
8. **context.pack** - ä¸Šä¸‹æ–‡æ‰“åŒ…å’Œå„ªåŒ–

#### æŒä¹…åŒ–ç›®éŒ„çµæ§‹
```
.addp/
â”œâ”€â”€ specifications/     # é …ç›®è¦æ ¼å’Œéœ€æ±‚æ–‡æª”
â”œâ”€â”€ workflows/         # ADDP å››éšæ®µå·¥ä½œæµç‹€æ…‹
â”œâ”€â”€ memory/           # è·¨å·¥å…·è¨˜æ†¶å’Œä¸Šä¸‹æ–‡
â”œâ”€â”€ queries/          # æŸ¥è©¢å„ªåŒ–ç·©å­˜å’Œæ¨¡æ¿
â”œâ”€â”€ gates/            # è³ªé‡é–€ç¦æª¢æŸ¥è¨˜éŒ„
â”œâ”€â”€ sync/             # å·¥å…·ç‹€æ…‹åŒæ­¥æ•¸æ“š
â””â”€â”€ configs/          # é…ç½®ç®¡ç†å’Œæ¨¡æ¿
```

#### é©—æ”¶æ¼”ç¤ºå ´æ™¯
1. **Golang ä»£ç†æ¼”ç¤º**ï¼šå•Ÿå‹•ä»£ç† â†’ åˆ‡æ›çµ‚ç«¯ â†’ è¼¸å…¥æŸ¥è©¢ â†’ é¡¯ç¤º Ollama å„ªåŒ– â†’ ç™¼é€åˆ°é¸å®š AI å·¥å…·
2. **Python MCP æ¼”ç¤º**ï¼šé…ç½® MCP â†’ èª¿ç”¨ test.run â†’ é©—è­‰ TDD æµç¨‹ â†’ ä¿å­˜åˆ° .addp/ â†’ æŸ¥çœ‹çµæ§‹åŒ–å ±å‘Š
3. **ç«¯åˆ°ç«¯æµç¨‹**ï¼šæœ¬åœ°å„ªåŒ– â†’ MCP å·¥å…·è™•ç† â†’ ç§»äº¤åˆ° AI CLI â†’ çµæœè¿”å› â†’ ç‹€æ…‹æŒä¹…åŒ–

é€™å€‹ DoD ç¢ºä¿å…©å€‹è»Œé“éƒ½æœ‰æ˜ç¢ºçš„å®Œæˆæ¨™æº–ï¼Œä¸¦ä¸”å®Œå…¨éµå¾ªç¨ç«‹æ¶æ§‹åŸå‰‡ã€‚