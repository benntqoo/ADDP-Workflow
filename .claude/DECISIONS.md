# 技術決策記錄

## 項目初始化 - 2025-08-16

**決策**：採用混合命令+代理雙軌系統架構 (v4.0)
**原因**：
- 結合命令系統的精確控制與代理系統的專業能力
- 提供漸進式遷移路徑，降低學習成本
- 實現零配置智能路由，提升開發效率
**影響**：確定了框架的基礎架構方向，實現人機協作最佳平衡

---

## 架構演進歷程

### v4.0.1 - 文檔優化 (2025-08-14)
**決策**：重組文檔結構，英文為主，中文為輔
**原因**：適應國際化需求，提升項目可訪問性
**影響**：擴大了項目的潛在用戶群體

### v4.0.0 - 混合系統 (2025-08-14)
**決策**：引入智能代理系統，與命令系統並存
**原因**：
- 命令系統提供精確控制但需要記憶
- 代理系統自動觸發但可能過度主動
- 混合架構取長補短，實現最佳平衡
**影響**：革命性提升開發效率，測試生成10倍提升，性能優化15倍提升

### v3.3.0 - 命令精簡 (2025-08-10)
**決策**：移除項目級命令，保留8個核心全局命令
**原因**：讓開發者自主建立項目特定命令，避免過度規範
**影響**：簡化了系統複雜度，提高了靈活性

---

## 設計原則

### 1. 簡單高效 (Less is More)
**決策**：核心命令控制在10個以內
**原因**：減少記憶負擔，提高使用效率
**實施**：8個核心命令 + 5個SDK專用命令

### 2. 智能協作 (Smart Collaboration)
**決策**：代理自動觸發，無需手動調用
**原因**：降低使用門檻，提升工作流暢度
**實施**：基於文件類型和代碼內容的智能路由

### 3. 漸進式遷移 (Progressive Migration)
**決策**：v4.0 完全向後兼容 v3.3
**原因**：保護現有用戶投資，降低遷移風險
**實施**：命令存檔系統，雙軌並行運行

### 4. 專業深度 (Professional Depth)
**決策**：為每個技術棧提供專門代理
**原因**：通用代理無法提供足夠專業的支持
**實施**：40+ 專業代理覆蓋主流技術棧

---

## 技術選型

### 代理模型分層
**決策**：根據任務複雜度使用不同模型（Haiku/Sonnet/Opus）
**原因**：平衡性能與成本，優化資源使用
**實施**：
- Haiku：簡單任務、快速響應
- Sonnet：標準開發任務
- Opus：複雜架構設計、深度分析

### 上下文檢測器
**決策**：為多用途語言提供專門的上下文檢測器
**原因**：解決 Kotlin/Java/C#/Python 等語言的場景衝突
**實施**：5個檢測器，信心評分系統（0.0-1.0）

---

## 待決策事項

- [ ] 是否需要引入更多語言的上下文檢測器？
- [ ] 如何優化代理之間的協作機制？
- [ ] 是否需要提供圖形化配置界面？
- [ ] 如何進一步降低 token 消耗？

---

## 決策模板

```markdown
## [日期] - [決策標題]
**決策**：[具體決策內容]
**原因**：[決策理由]
**影響**：[對項目的影響]
**替代方案**：[考慮過的其他方案]
**風險**：[潛在風險]
**緩解措施**：[風險緩解策略]
```

---

*本文檔由 `/learn` 命令自動維護，記錄所有重要技術決策*